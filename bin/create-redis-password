#!/bin/bash

if [[ "${BASH_SOURCE[0]}" != "${0}" ]]; then
  echo "This script is intended to be run, not sourced." >&2
  return 1
fi

read -srp "Enter the new Redis server password: " redis_pass
echo
read -srp "Re-enter the password: " redis_pass2
echo
if [ ! "${redis_pass}" = "${redis_pass2}" ]; then
  echo "Passwords do not match." 1>&2
  exit 1
fi
[[ -z "${redis_pass}" ]] && echo "Redis password cannot be blank." 1>&2 && exit 1

printf '%s' "${redis_pass}" | podman secret create quipucords-redis-password --replace -
podman secret ls --filter name=quipucords-redis-password
